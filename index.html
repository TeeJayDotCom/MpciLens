<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Inventory Soft</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <style>
        /* --- NEUMORPHISM VARIABLES --- */
        :root {
            --bg: #e0e5ec;
            --text-main: #4a4a4a;
            --text-light: #888;
            --accent: #3b82f6; /* Tech Blue */
            
            /* The Magic Shadows */
            --shadow-light: #ffffff;
            --shadow-dark: #a3b1c6;
            
            --ease-out: cubic-bezier(0.23, 1, 0.32, 1);
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            background-color: var(--bg); 
            color: var(--text-main); 
            margin: 0; 
            padding: 0; 
            padding-bottom: 100px;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- 1. SOFT HEADER --- */
        .search-container { 
            position: sticky; 
            top: 0; 
            background: var(--bg);
            padding: 20px; 
            z-index: 100; 
            /* Soft shadow below header */
            box-shadow: 0 10px 20px rgba(163, 177, 198, 0.3);
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        /* INSET SHADOW (Pressed In) */
        input { 
            width: 100%; 
            padding: 18px 20px 18px 50px; 
            font-size: 16px; 
            border: none;
            border-radius: 50px; 
            background: var(--bg); 
            color: var(--text-main); 
            outline: none;
            box-sizing: border-box;
            font-weight: 600;
            
            /* The "Carved" Look */
            box-shadow: inset 6px 6px 12px var(--shadow-dark), 
                        inset -6px -6px 12px var(--shadow-light);
            
            transition: all 0.2s ease;
        }

        input:focus { color: var(--accent); }
        input::placeholder { color: #a1aab9; font-weight: 400; }

        .search-icon {
            position: absolute;
            left: 20px;
            font-size: 18px;
            opacity: 0.5;
            pointer-events: none;
        }

        /* --- 2. 3D CARDS --- */
        #listContainer { padding: 24px; }

        .card { 
            background: var(--bg); 
            margin-bottom: 24px; 
            padding: 24px; 
            border-radius: 24px; 
            cursor: pointer;
            position: relative;
            
            /* The "Pop Out" Look */
            box-shadow: 9px 9px 16px var(--shadow-dark), 
                       -9px -9px 16px var(--shadow-light);
                       
            transition: all 0.2s var(--ease-out);
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* Click Effect: Becomes Inset */
        .card:active {
            transform: scale(0.98);
            box-shadow: inset 6px 6px 12px var(--shadow-dark), 
                        inset -6px -6px 12px var(--shadow-light);
        }

        .card-header {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 16px;
            align-items: center;
        }

        /* Round Icon Button Look */
        .icon-box {
            width: 50px; height: 50px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px;
            color: var(--accent);
            /* Small pop out for icon */
            box-shadow: 5px 5px 10px var(--shadow-dark), 
                       -5px -5px 10px var(--shadow-light);
        }

        .info-col { display: flex; flex-direction: column; gap: 6px; }

        .item-name { 
            font-size: 16px; 
            font-weight: 700; 
            color: #333;
            line-height: 1.3;
        }

        .item-code { 
            font-size: 12px; 
            color: var(--text-light); 
            font-family: monospace;
            background: rgba(0,0,0,0.03);
            padding: 4px 8px;
            border-radius: 8px;
            width: fit-content;
        }

        /* Qty Indent */
        .qty-box {
            text-align: center;
            padding: 8px 12px;
            border-radius: 12px;
            /* Pressed in for data */
            box-shadow: inset 3px 3px 6px var(--shadow-dark), 
                        inset -3px -3px 6px var(--shadow-light);
        }
        .qty-val { font-size: 18px; font-weight: 800; color: var(--accent); display: block; }
        .qty-lbl { font-size: 10px; color: var(--text-light); text-transform: uppercase; font-weight: 600; }

        /* --- 3. SPECS DRAWER --- */
        .expand-trigger {
            margin-top: 20px;
            display: flex; justify-content: center;
        }
        .expand-btn {
            background: transparent; border: none;
            color: var(--text-light); font-weight: 600; font-size: 12px;
            cursor: pointer; display: flex; align-items: center; gap: 5px;
        }

        .details-grid {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(0,0,0,0.05);
        }

        .spec-item {
            display: flex; flex-direction: column;
            padding: 10px;
            border-radius: 12px;
            background: var(--bg);
            /* Slight pop out */
            box-shadow: 3px 3px 6px var(--shadow-dark), 
                       -3px -3px 6px var(--shadow-light);
        }
        .spec-lbl { font-size: 10px; text-transform: uppercase; color: var(--text-light); margin-bottom: 2px; }
        .spec-val { font-size: 14px; font-weight: 600; color: var(--text-main); }


        /* --- 4. FLOATING BUTTONS (Soft Spheres) --- */
        .fab-container { position: fixed; bottom: 30px; right: 24px; display: flex; flex-direction: column; gap: 16px; z-index: 200; }
        .fab { 
            width: 50px; height: 50px; 
            border-radius: 50%; border: none; 
            background: var(--bg); color: var(--text-main);
            font-size: 20px; 
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            box-shadow: 6px 6px 12px var(--shadow-dark), 
                       -6px -6px 12px var(--shadow-light);
            transition: transform 0.2s;
        }
        .fab:active {
            transform: scale(0.95);
            box-shadow: inset 3px 3px 6px var(--shadow-dark), 
                        inset -3px -3px 6px var(--shadow-light);
            color: var(--accent);
        }

        /* --- UTILS --- */
        .empty-state { text-align: center; margin-top: 60px; color: var(--text-light); font-weight: 500; }
        .status-bar { text-align: center; font-size: 11px; color: var(--text-light); margin-top: 10px; }

        #toast {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%) translateY(20px);
            background: var(--bg); padding: 12px 24px; border-radius: 40px;
            color: var(--accent); font-weight: 700;
            box-shadow: 5px 5px 15px var(--shadow-dark), -5px -5px 15px var(--shadow-light);
            opacity: 0; pointer-events: none; transition: 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 1000;
            display: flex; align-items: center; gap: 8px;
        }
        #toast.active { opacity: 1; transform: translateX(-50%) translateY(0); }

    </style>
</head>
<body>

    <div class="search-container">
        <div class="input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Type to search..." autocomplete="off">
        </div>
        <div id="statusBar" class="status-bar">Connecting...</div>
    </div>

    <div id="listContainer">
        </div>

    <div id="toast">‚úÖ Copied to clipboard</div>

    <div class="fab-container">
        <button class="fab" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚¨Ü</button>
        <button class="fab" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'})">‚¨á</button>
    </div>

    <script>
        const FILE_NAME = "inventory.xlsx"; 
        let allData = [];

        function getIcon(name) {
            const n = name ? name.toUpperCase() : "";
            if (n.includes("CAP") || n.includes("SCREW")) return "üîò"; 
            if (n.includes("CUP") || n.includes("DOSE")) return "ü•É"; 
            if (n.includes("JAR") || n.includes("HONEY")) return "üçØ"; 
            if (n.includes("BOTTLE") || n.includes("PET")) return "üß¥"; 
            if (n.includes("PUMP") || n.includes("SPRAY")) return "üî´";
            return "üì¶"; 
        }

        async function loadInventory() {
            const status = document.getElementById('statusBar');
            try {
                const response = await fetch(FILE_NAME + "?t=" + new Date().getTime());
                if (!response.ok) throw new Error("File missing");
                
                const buffer = await response.arrayBuffer();
                const workbook = XLSX.read(buffer);
                const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                
                const getVal = (r,k) => r[Object.keys(r).find(key=>key.toUpperCase().includes(k.toUpperCase()))];

                allData = json.map(r => ({
                    code: getVal(r,"Code")||"N/A", name: getVal(r,"Name")||"Unknown",
                    qty: getVal(r,"Qty")||getVal(r,"Quantity")||"0",
                    weight: getVal(r,"Weight")||"-", height: getVal(r,"Height")||"-",
                    ofc: getVal(r,"OFC")||"-", dia: getVal(r,"Dia")||"-"
                }));

                status.innerText = `${allData.length} Items Ready`;
                renderEmpty();

            } catch (err) {
                status.innerText = "Connection Error";
                status.style.color = "red";
            }
        }

        function renderEmpty() {
            document.getElementById('listContainer').innerHTML = `
                <div class="empty-state">
                    <p style="font-size:40px; opacity:0.3; margin-bottom:10px">‚å®Ô∏è</p>
                    <p>Start typing to search</p>
                </div>`;
        }

        function renderList(items) {
            const container = document.getElementById('listContainer');
            container.innerHTML = "";

            if (items.length === 0) {
                container.innerHTML = `<div class="empty-state"><p>No matches found</p></div>`;
                return;
            }

            items.forEach((item, idx) => {
                const icon = getIcon(item.name);
                const el = document.createElement('div');
                el.className = 'card';
                
                el.onclick = (e) => {
                    if(!e.target.closest('.expand-trigger')) copyData(item, icon);
                };
                
                el.innerHTML = `
                    <div class="card-header">
                        <div class="icon-box">${icon}</div>
                        <div class="info-col">
                            <div class="item-name">${item.name}</div>
                            <div class="item-code">${item.code}</div>
                        </div>
                        <div class="qty-box">
                            <span class="qty-val">${item.qty}</span>
                            <span class="qty-lbl">Box</span>
                        </div>
                    </div>

                    <div class="expand-trigger">
                        <button class="expand-btn" onclick="toggleSpecs('s-${idx}', this)">
                            View Specs ‚åÑ
                        </button>
                    </div>

                    <div id="s-${idx}" class="details-grid">
                        <div class="spec-item"><span class="spec-lbl">Weight</span><span class="spec-val">${item.weight}</span></div>
                        <div class="spec-item"><span class="spec-lbl">Height</span><span class="spec-val">${item.height}</span></div>
                        <div class="spec-item"><span class="spec-lbl">OFC</span><span class="spec-val">${item.ofc}</span></div>
                        <div class="spec-item"><span class="spec-lbl">Diameter</span><span class="spec-val">${item.dia}</span></div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        function copyData(item, icon) {
            const txt = `${icon} ${item.name}\nCode: ${item.code}\nQty: ${item.qty}\n\nSpecs:\nW: ${item.weight} | H: ${item.height}\nOFC: ${item.ofc} | D: ${item.dia}`;
            navigator.clipboard.writeText(txt);
            
            const t = document.getElementById('toast');
            t.classList.add('active');
            setTimeout(() => t.classList.remove('active'), 2000);
        }

        window.toggleSpecs = function(id, btn) {
            const el = document.getElementById(id);
            const isHidden = getComputedStyle(el).display === "none";
            el.style.display = isHidden ? "grid" : "none";
            btn.innerHTML = isHidden ? "Hide Specs ‚åÉ" : "View Specs ‚åÑ";
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            const val = e.target.value.toUpperCase().trim();
            if (!val) { renderEmpty(); return; }
            
            const terms = val.split(" ").filter(Boolean);
            const res = allData.filter(i => {
                const str = (i.name + " " + i.code).toUpperCase();
                return terms.every(t => str.includes(t));
            });
            renderList(res);
        });

        loadInventory();
    </script>
</body>
</html>
