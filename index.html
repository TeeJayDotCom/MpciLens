<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FG Inventory: ULTRA PERFORMANCE</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <style>
        :root {
            --bg-deep: #0f0f13;
            --glass-surface: rgba(255, 255, 255, 0.04);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --primary-accent: #c084fc;
            --gradient-primary: linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%);
        }

        /* PERFORMANCE FIX: hardware acceleration for smooth scrolling */
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; color: var(--text-main); margin: 0; 
            background-color: var(--bg-deep); min-height: 101vh;
            -webkit-font-smoothing: antialiased;
            transform: translateZ(0); 
        }

        /* --- STYLES PRESERVED FROM LUXURY VERSION --- */
        #passwordOverlay { position: fixed; inset: 0; background: var(--bg-deep); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(20px); }
        #passwordOverlay.hidden { display: none; }
        .pass-card { background: var(--glass-surface); border: 1px solid var(--glass-border); padding: 40px; border-radius: 30px; text-align: center; width: 85%; max-width: 380px; }
        .pass-input { width: 100%; padding: 15px; border-radius: 15px; border: 1px solid var(--glass-border); background: rgba(255,255,255,0.05); color: white; text-align: center; font-size: 18px; outline: none; margin-top: 25px; box-sizing: border-box; }
        .pass-btn { margin-top: 20px; width: 100%; padding: 16px; border-radius: 15px; background: var(--gradient-primary); color: white; font-weight: 800; border: none; cursor: pointer; }
        
        .search-container { position: sticky; top: 0; padding: 20px 24px 10px 24px; z-index: 100; background: rgba(15, 15, 19, 0.9); backdrop-filter: blur(20px); border-bottom: 1px solid var(--glass-border); }
        .input-wrapper { position: relative; }
        input { width: 100%; padding: 16px 20px 16px 50px; font-size: 16px; font-weight: 500; border-radius: 24px; border: 1px solid var(--glass-border); background: rgba(255, 255, 255, 0.05); color: white; outline: none; box-sizing: border-box; }
        input:focus { border-color: #EC4899; }
        .search-icon-overlay { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); opacity: 0.5; font-size: 18px;}
        #searchCounter { font-size: 11px; background: var(--gradient-primary); padding: 5px 12px; border-radius: 20px; font-weight: 800; margin-top: 12px; display: inline-block; }
        #status-bar { font-size: 12px; text-align: center; margin-top: 10px; font-weight: 700; color: #10b981; }

        #listContainer { padding: 20px 24px; padding-bottom: 160px; contain: content; }
        .card { background: var(--glass-surface); border: 1px solid var(--glass-border); border-radius: 24px; padding: 22px; margin-bottom: 18px; will-change: transform; }
        .card-header { display: flex; align-items: center; gap: 16px; }
        .icon-circle { width: 56px; height: 56px; border-radius: 50%; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; font-size: 28px; flex-shrink: 0; }
        .item-name { font-size: 17px; font-weight: 700; margin-bottom: 4px; line-height: 1.3;}
        .qty-box { background: var(--gradient-primary); padding: 10px 14px; border-radius: 18px; text-align: center; min-width: 55px; }
        .qty-val { font-size: 18px; font-weight: 800; display: block; }
        .expand-btn { width: 100%; background: transparent; border: none; color: #c4b5fd; margin-top: 15px; cursor: pointer; font-size: 12px; font-weight: 600; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 12px;}
        .details { display: none; margin-top: 15px; grid-template-columns: 1fr 1fr; gap: 10px; }
        .spec-pill { background: rgba(0,0,0,0.2); padding: 10px; border-radius: 12px; text-align: center; }
        .spec-lbl { color: var(--primary-accent); font-size: 10px; text-transform: uppercase; font-weight: 800; display: block; margin-bottom: 4px; }
        .spec-val { color: white; font-weight: 700; font-size: 15px; }

        .fab-container { position: fixed; bottom: 40px; right: 24px; display: flex; flex-direction: column; gap: 16px; z-index: 200; }
        .fab { background: #1e1e24; border: 1px solid rgba(255,255,255,0.2); color: white; width: 50px; height: 50px; border-radius: 50%; font-size: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer;}
    </style>
</head>
<body>

    <div id="passwordOverlay">
        <div class="pass-card">
            <h2 style="margin:0; font-weight:800;">SECURE ACCESS</h2>
            <input type="password" id="passInput" class="pass-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            <button class="pass-btn" onclick="checkPassword()">UNLOCK</button>
        </div>
    </div>

    <div class="search-container">
        <div class="input-wrapper">
            <span class="search-icon-overlay">üîç</span>
            <input type="text" id="searchInput" placeholder="Search Code & Name..." autocomplete="off">
        </div>
        <div style="text-align: center;">
            <div id="searchCounter" style="display:none;">READY</div>
            <div id="status-bar"><span>‚óè</span> Connecting...</div>
        </div>
    </div>

    <div id="listContainer"></div>

    <div class="fab-container">
        <button class="fab" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚¨Ü</button>
        <button class="fab" onclick="window.scrollTo({top: 99999, behavior: 'smooth'})">‚¨á</button>
    </div>

    <script>
        const FILE_NAME = "inventory.xlsx";
        const CORRECT_PASSWORD = "123";
        let allData = [];
        let searchTimeout;

        function checkPassword() {
            if (document.getElementById('passInput').value === CORRECT_PASSWORD) {
                document.getElementById('passwordOverlay').classList.add('hidden');
                loadInventory();
            } else { alert("ACCESS DENIED"); }
        }

        async function loadInventory() {
            const status = document.getElementById('status-bar');
            try {
                const response = await fetch(FILE_NAME + "?t=" + Date.now());
                const workbook = XLSX.read(await response.arrayBuffer());
                const rawData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                allData = rawData.map(row => ({
                    code: String(row["Item Code"] || "N/A"),
                    name: String(row["Item Name"] || "Unknown"),
                    qty: row["Quantity per Box"] || "0",
                    weight: row["Weight"] || "-",
                    height: row["Height"] || "-",
                    ofc: row["OFC"] || "-",
                    dia: row["Body Dia Major"] || "-"
                }));
                status.innerHTML = `<span>‚óè</span> ${allData.length} ASSETS ACTIVE`;
                renderEmpty();
            } catch (e) { status.innerHTML = "‚óè ERROR"; }
        }

        function renderEmpty() {
            document.getElementById('listContainer').innerHTML = `<div style="text-align:center;margin-top:80px;opacity:0.5;">‚ú® Ready to Search</div>`;
            document.getElementById('searchCounter').style.display = 'none';
        }

        // IMPROVEMENT: Using DocumentFragment to batch DOM updates
        function renderList(items) {
            const container = document.getElementById('listContainer');
            const counterBadge = document.getElementById('searchCounter');
            const fragment = document.createDocumentFragment();

            container.innerHTML = ""; 
            counterBadge.style.display = 'inline-block';
            counterBadge.innerText = `FOUND: ${items.length} ITEMS`;

            if (items.length === 0) {
                container.innerHTML = `<div style="text-align:center;margin-top:80px;opacity:0.5;">üî≠ No matches</div>`;
                return;
            }

            // Limit initial render to 50 items for speed, load rest on scroll if needed 
            // (For simplicity here, we render all, but optimized)
            items.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <div class="icon-circle">üì¶</div>
                        <div class="info">
                            <div class="item-name">${item.name}</div>
                            <div style="font-size:12px; color:var(--primary-accent); font-weight:700;">${item.code}</div>
                        </div>
                        <div class="qty-box"><span class="qty-val">${item.qty}</span><span style="font-size:9px; font-weight:800;">PCS</span></div>
                    </div>
                    <button class="expand-btn" onclick="toggleDetails('d-${index}', this)">VIEW SPECS ‚ñæ</button>
                    <div id="d-${index}" class="details">
                        <div class="spec-pill"><span class="spec-lbl">Weight</span><span class="spec-val">${item.weight}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">Height</span><span class="spec-val">${item.height}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">OFC</span><span class="spec-val">${item.ofc}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">Dia</span><span class="spec-val">${item.dia}</span></div>
                    </div>`;
                fragment.appendChild(card);
            });
            container.appendChild(fragment);
        }

        window.toggleDetails = (id, btn) => {
            const el = document.getElementById(id);
            const isHidden = getComputedStyle(el).display === "none";
            el.style.display = isHidden ? "grid" : "none";
            btn.innerHTML = isHidden ? "HIDE SPECS ‚ñ¥" : "VIEW SPECS ‚ñæ";
        }

        // IMPROVEMENT: Debouncing the search to prevent lag while typing
        document.getElementById('searchInput').addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            const val = e.target.value.toUpperCase().trim();
            
            if (!val) { renderEmpty(); return; }

            searchTimeout = setTimeout(() => {
                const words = val.split(" ");
                const filtered = allData.filter(item => {
                    const combinedText = (item.name + " " + item.code).toUpperCase();
                    return words.every(word => combinedText.includes(word));
                });
                renderList(filtered);
            }, 150); // 150ms delay
        });
    </script>
</body>
</html>
    <div class="icon-circle">üì¶</div>
                        <div class="info">
                            <div class="item-name">${item.name}</div>
                            <div style="font-size:12px; opacity:0.5;">${item.code}</div>
                        </div>
                        <div class="qty-box"><span class="qty-val">${item.qty}</span><span style="font-size:9px;">BOX</span></div>
                    </div>
                    <button class="expand-btn" onclick="toggleDetails('d-${index}', this)">VIEW SPECS ‚ñæ</button>
                    <div id="d-${index}" class="details">
                        <div class="spec-pill"><span class="spec-lbl">Weight</span><span class="spec-val">${item.weight}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">Height</span><span class="spec-val">${item.height}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">OFC</span><span class="spec-val">${item.ofc}</span></div>
                        <div class="spec-pill"><span class="spec-lbl">Dia</span><span class="spec-val">${item.dia}</span></div>
                    </div>`;
                container.appendChild(card);
            });
        }

        function copyData(item) {
            navigator.clipboard.writeText(`${item.name} (${item.code}) Qty: ${item.qty}`);
            const t = document.getElementById("toast");
            t.classList.add("show");
            setTimeout(()=>t.classList.remove("show"), 2000);
        }

        window.toggleDetails = (id, btn) => {
            const el = document.getElementById(id);
            const isHidden = getComputedStyle(el).display === "none";
            el.style.display = isHidden ? "grid" : "none";
            btn.innerHTML = isHidden ? "HIDE SPECS ‚ñ¥" : "VIEW SPECS ‚ñæ";
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            const val = e.target.value.toUpperCase();
            if (!val.trim()) { renderEmpty(); return; }
            const res = allData.filter(i => (i.name + i.code).toUpperCase().includes(val));
            renderList(res);
        });
    </script>
</body>
    </html>
    
