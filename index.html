<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>INVENTORY_SYS</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; margin: 0; background: #f0f0f0; color: #000; padding-bottom: 100px; }
        
        /* HEADER */
        .header { position: sticky; top: 0; background: #fff; border-bottom: 2px solid #000; padding: 16px; z-index: 100; }
        .search-wrapper { display: flex; align-items: center; border: 2px solid #000; background: #fff; height: 50px; }
        .search-icon { padding: 0 16px; font-size: 20px; }
        input { border: none; font-size: 18px; font-weight: bold; width: 100%; outline: none; text-transform: uppercase; letter-spacing: 1px; }

        /* LIST */
        .list-container { padding: 0; }
        .card { background: #fff; border-bottom: 1px solid #000; padding: 20px; display: grid; grid-template-columns: 1fr auto; gap: 10px; cursor: pointer; }
        .card:active { background: #000; color: #fff; }
        
        .name-group { display: flex; flex-direction: column; gap: 5px; }
        .item-name { font-size: 20px; font-weight: 800; line-height: 1.1; }
        .item-code { font-size: 12px; font-family: monospace; opacity: 0.6; }

        .qty-group { text-align: right; min-width: 80px; }
        .qty { font-size: 32px; font-weight: 900; color: #ff3b30; letter-spacing: -1px; }
        .card:active .qty { color: #fff; }
        .unit { font-size: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }

        /* SPECS GRID */
        .specs { display: none; grid-column: 1 / -1; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; padding-top: 15px; border-top: 1px dotted #000; }
        .card:active .specs { border-color: #555; }
        .spec-item { display: flex; flex-direction: column; }
        .spec-label { font-size: 9px; text-transform: uppercase; opacity: 0.5; }
        .spec-val { font-size: 14px; font-weight: bold; font-family: monospace; }
        
        /* UTILS */
        .empty { padding: 40px; text-align: center; font-weight: bold; opacity: 0.4; text-transform: uppercase; letter-spacing: 2px; }
        .fab { position: fixed; bottom: 30px; right: 20px; width: 50px; height: 50px; background: #000; color: #fff; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 24px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    </style>
</head>
<body>
    <div class="header">
        <div class="search-wrapper">
            <span class="search-icon">→</span>
            <input type="text" id="searchInput" placeholder="SEARCH ASSETS...">
        </div>
    </div>
    <div id="list" class="list-container"><div class="empty">SYSTEM READY</div></div>
    <div class="fab" onclick="window.scrollTo(0,0)">↑</div>

    <script>
        const FILE_NAME = "inventory.xlsx";
        let allData = [];

        async function init() {
            try {
                const res = await fetch(FILE_NAME + "?t=" + Date.now());
                const wb = XLSX.read(await res.arrayBuffer());
                const json = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
                const find = (r, k) => r[Object.keys(r).find(x => x.toUpperCase().includes(k.toUpperCase()))];
                
                allData = json.map(r => ({
                    c: find(r,"Code")||"-", n: find(r,"Name")||"UNKNOWN", q: find(r,"Qty")||find(r,"Quantity")||"0",
                    w: find(r,"Weight")||"-", h: find(r,"Height")||"-", o: find(r,"OFC")||"-", d: find(r,"Dia")||"-"
                }));
            } catch(e) { alert(e.message); }
        }

        function render(items) {
            const list = document.getElementById('list');
            list.innerHTML = items.length ? "" : "<div class='empty'>NO RESULTS</div>";
            items.forEach((i, idx) => {
                const el = document.createElement('div');
                el.className = 'card';
                el.onclick = () => {
                    const specs = document.getElementById(`s-${idx}`);
                    specs.style.display = specs.style.display === 'grid' ? 'none' : 'grid';
                    navigator.clipboard.writeText(`${i.n} ${i.q}`); 
                };
                el.innerHTML = `
                    <div class="name-group"><div class="item-name">${i.n}</div><div class="item-code">${i.c}</div></div>
                    <div class="qty-group"><div class="qty">${i.q}</div><div class="unit">BOX</div></div>
                    <div id="s-${idx}" class="specs">
                        <div class="spec-item"><span class="spec-label">WGT</span><span class="spec-val">${i.w}</span></div>
                        <div class="spec-item"><span class="spec-label">HGT</span><span class="spec-val">${i.h}</span></div>
                        <div class="spec-item"><span class="spec-label">OFC</span><span class="spec-val">${i.o}</span></div>
                        <div class="spec-item"><span class="spec-label">DIA</span><span class="spec-val">${i.d}</span></div>
                    </div>`;
                list.appendChild(el);
            });
        }

        document.getElementById('searchInput').addEventListener('input', e => {
            const v = e.target.value.toUpperCase().split(" ").filter(Boolean);
            render(v.length ? allData.filter(i => v.every(w => (i.n+i.c).toUpperCase().includes(w))) : []);
        });
        init();
    </script>
</body>
</html>
