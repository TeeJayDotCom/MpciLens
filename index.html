<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FG Inventory</title>

<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

<style>
/* =========================
   ENTERPRISE / LUXURY THEME
========================= */

:root {
  --bg: #0b0c0f;
  --panel: #12141a;
  --border: #1f2330;

  --text-main: #e6e8ee;
  --text-sub: #9aa1b2;
  --text-muted: #6b7280;

  --accent: #8b93ff;

  --radius: 10px;
}

/* GLOBAL */
body {
  margin: 0;
  padding: 20px;
  padding-bottom: 90px;
  background: var(--bg);
  color: var(--text-main);
  font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

/* STATUS */
#status-bar {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  font-size: 13px;
  color: var(--text-sub);
  margin-bottom: 18px;
}

/* SEARCH */
.search-container {
  position: sticky;
  top: 0;
  background: var(--bg);
  padding-bottom: 16px;
  z-index: 10;
}

.search-container input {
  width: 100%;
  padding: 16px 18px;
  font-size: 15px;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-main);
  outline: none;
}

.search-container input:focus {
  border-color: var(--accent);
}

/* LIST */
.empty-state {
  text-align: center;
  margin-top: 80px;
  font-size: 14px;
  color: var(--text-muted);
}

/* PANEL */
.card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 18px;
  margin-bottom: 14px;
  transition: border-color 0.2s ease;
}

.card:hover {
  border-color: var(--accent);
}

/* HEADER */
.card-header {
  display: flex;
  justify-content: space-between;
  gap: 16px;
}

.item-name {
  font-size: 16px;
  font-weight: 600;
}

.item-code {
  margin-top: 6px;
  font-size: 12px;
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  color: var(--text-muted);
}

/* QTY */
.qty-box {
  text-align: right;
}

.qty-val {
  font-size: 20px;
  font-weight: 700;
}

.qty-lbl {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
}

/* DETAILS */
.expand-btn {
  margin-top: 12px;
  background: none;
  border: none;
  padding: 0;
  font-size: 13px;
  color: var(--accent);
  cursor: pointer;
}

.details {
  display: none;
  margin-top: 14px;
  padding-top: 12px;
  border-top: 1px solid var(--border);
  font-size: 13px;
  color: var(--text-sub);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

/* FAB */
.fab-container {
  position: fixed;
  bottom: 22px;
  right: 22px;
  display: flex;
  gap: 12px;
}

.fab {
  width: 46px;
  height: 46px;
  border-radius: 50%;
  background: var(--panel);
  border: 1px solid var(--border);
  color: var(--text-main);
  font-size: 18px;
  cursor: pointer;
}

/* TOAST */
#toast {
  visibility: hidden;
  position: fixed;
  left: 50%;
  bottom: 30px;
  transform: translateX(-50%);
  background: var(--panel);
  border: 1px solid var(--border);
  padding: 14px 20px;
  border-radius: 999px;
  font-size: 14px;
}

#toast.show {
  visibility: visible;
}
</style>
</head>

<body>

<div id="status-bar">Initializing…</div>

<div class="search-container">
  <input id="searchInput" placeholder="Search item name or code">
</div>

<div id="listContainer">
  <div class="empty-state">Loading inventory…</div>
</div>

<div id="toast">Copied</div>

<div class="fab-container">
  <button class="fab" onclick="scrollTo(0,0)">↑</button>
  <button class="fab" onclick="scrollTo(0,document.body.scrollHeight)">↓</button>
</div>

<script>
const FILE_NAME = "inventory.xlsx";
let allData = [];

async function loadInventory() {
  const status = document.getElementById("status-bar");

  try {
    const res = await fetch(FILE_NAME + "?t=" + Date.now());
    if (!res.ok) throw new Error("File not found");

    const buf = await res.arrayBuffer();
    const wb = XLSX.read(buf);
    const sheet = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet);

    allData = rows.map(r => ({
      code: r["Item Code"] || "-",
      name: r["Item Name"] || "Unknown Item",
      qty: r["Quantity per Box"] || "-",
      weight: r["Weight"] || "-",
      height: r["Height"] || "-",
      ofc: r["OFC"] || "-",
      dia: r["Body Dia Major"] || "-"
    }));

    status.textContent = `Ready • ${allData.length} items`;
    document.getElementById("listContainer").innerHTML =
      `<div class="empty-state">Start typing to search</div>`;

  } catch (e) {
    status.textContent = "Failed to load inventory";
  }
}

function renderList(items) {
  const container = document.getElementById("listContainer");
  container.innerHTML = "";

  if (!items.length) {
    container.innerHTML = `<div class="empty-state">No results</div>`;
    return;
  }

  items.forEach((it, i) => {
    const card = document.createElement("div");
    card.className = "card";

    card.onclick = e => {
      if (e.target.className === "expand-btn") return;
      navigator.clipboard.writeText(
        `${it.name}\nCode: ${it.code}\nQty/Box: ${it.qty}`
      ).then(showToast);
    };

    card.innerHTML = `
      <div class="card-header">
        <div>
          <div class="item-name">${it.name}</div>
          <div class="item-code">${it.code}</div>
        </div>
        <div class="qty-box">
          <div class="qty-val">${it.qty}</div>
          <div class="qty-lbl">Box</div>
        </div>
      </div>

      <button class="expand-btn" onclick="toggleDetails('d${i}')">
        View technical details
      </button>

      <div id="d${i}" class="details">
        <div>Weight: ${it.weight}</div>
        <div>Height: ${it.height}</div>
        <div>OFC: ${it.ofc}</div>
        <div>Diameter: ${it.dia}</div>
      </div>
    `;
    container.appendChild(card);
  });
}

function toggleDetails(id) {
  const el = document.getElementById(id);
  el.style.display = el.style.display === "grid" ? "none" : "grid";
}

function showToast() {
  const t = document.getElementById("toast");
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 2000);
}

document.getElementById("searchInput").addEventListener("input", e => {
  const q = e.target.value.trim().toUpperCase();
  if (!q) {
    document.getElementById("listContainer").innerHTML =
      `<div class="empty-state">Start typing to search</div>`;
    return;
  }

  const words = q.split(" ");
  const filtered = allData.filter(i =>
    words.every(w => (i.name + i.code).toUpperCase().includes(w))
  );

  renderList(filtered);
});

loadInventory();
</script>

</body>
</html>
