<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FG Search</title>

<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

<style>
/* ===============================
   REFERENCE-STYLE VISUAL SYSTEM
================================ */

:root {
  --bg1: #1b1f3b;
  --bg2: #0f1224;

  --glass: rgba(255,255,255,.08);
  --glass-border: rgba(255,255,255,.15);

  --text-main: #f3f4ff;
  --text-sub: #b4b7ff;
  --text-muted: #8a8ecf;

  --accent-pink: #ff6bcb;
  --accent-purple: #7c7cff;
  --accent-orange: #ff9f68;

  --radius: 18px;
}

/* BACKGROUND */
body {
  margin: 0;
  min-height: 100vh;
  background:
    radial-gradient(circle at top right, #2b2f6f, transparent 60%),
    linear-gradient(160deg, var(--bg1), var(--bg2));
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color: var(--text-main);
  overflow-y: auto;
}

/* APP CONTAINER */
.app {
  max-width: 520px;
  margin: auto;
  padding: 22px 18px 120px;
}

/* HEADER */
.header {
  margin-bottom: 20px;
}

.header h1 {
  font-size: 26px;
  font-weight: 700;
  line-height: 1.2;
}

.header span {
  color: var(--accent-orange);
}

/* SEARCH */
.search {
  position: sticky;
  top: 0;
  z-index: 10;
  padding-bottom: 14px;
  background: linear-gradient(180deg, rgba(27,31,59,.95), rgba(27,31,59,.6), transparent);
}

.search input {
  width: 100%;
  padding: 16px 20px;
  border-radius: 999px;
  border: 1px solid var(--glass-border);
  background: var(--glass);
  backdrop-filter: blur(14px);
  color: var(--text-main);
  font-size: 15px;
  outline: none;
}

.search input:focus {
  border-color: var(--accent-purple);
  box-shadow: 0 0 0 4px rgba(124,124,255,.25);
}

/* CARD */
.card {
  background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.05));
  backdrop-filter: blur(18px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 18px;
  margin-bottom: 16px;
  box-shadow: 0 20px 40px rgba(0,0,0,.35);
  transition: transform .25s ease;
}

.card:hover {
  transform: translateY(-4px);
}

/* CARD HEADER */
.card-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.item-name {
  font-size: 16px;
  font-weight: 600;
}

.item-code {
  font-size: 12px;
  margin-top: 6px;
  color: var(--text-muted);
}

/* SCORE BUBBLE */
.bubble {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 16px;
}

/* DETAILS */
.toggle {
  margin-top: 12px;
  font-size: 13px;
  color: var(--text-sub);
  cursor: pointer;
}

.details {
  display: none;
  margin-top: 14px;
  padding-top: 12px;
  border-top: 1px dashed rgba(255,255,255,.25);
  font-size: 13px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

/* EMPTY */
.empty {
  text-align: center;
  margin-top: 100px;
  color: var(--text-muted);
}

/* BOUNCE EFFECT */
.bounce {
  animation: bounce .4s ease;
}

@keyframes bounce {
  0% { transform: translateY(0); }
  40% { transform: translateY(-14px); }
  100% { transform: translateY(0); }
}
</style>
</head>

<body>

<div class="app" id="app">

  <div class="header">
    <h1>FG <span>Search</span></h1>
  </div>

  <div class="search">
    <input id="searchInput" placeholder="Search item name or code">
  </div>

  <div id="list">
    <div class="empty">Loading data…</div>
  </div>

</div>

<script>
const FILE = "inventory.xlsx";
let DATA = [];

async function loadExcel() {
  const res = await fetch(FILE + "?t=" + Date.now());
  const buf = await res.arrayBuffer();
  const wb = XLSX.read(buf);
  const sheet = wb.Sheets[wb.SheetNames[0]];
  DATA = XLSX.utils.sheet_to_json(sheet);
  document.getElementById("list").innerHTML =
    `<div class="empty">Start typing to search</div>`;
}

function render(items) {
  const list = document.getElementById("list");
  list.innerHTML = "";

  if (!items.length) {
    list.innerHTML = `<div class="empty">No results</div>`;
    return;
  }

  items.forEach((r, i) => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="card-top">
        <div>
          <div class="item-name">${r["Item Name"] || "Unknown"}</div>
          <div class="item-code">${r["Item Code"] || "-"}</div>
        </div>
        <div class="bubble">${r["Quantity per Box"] || "-"}</div>
      </div>

      <div class="toggle" onclick="toggle('d${i}')">
        View details →
      </div>

      <div class="details" id="d${i}">
        <div>Weight: ${r["Weight"] || "-"}</div>
        <div>Height: ${r["Height"] || "-"}</div>
        <div>OFC: ${r["OFC"] || "-"}</div>
        <div>Dia: ${r["Body Dia Major"] || "-"}</div>
      </div>
    `;
    list.appendChild(card);
  });
}

function toggle(id) {
  const d = document.getElementById(id);
  d.style.display = d.style.display === "grid" ? "none" : "grid";
}

document.getElementById("searchInput").addEventListener("input", e => {
  const q = e.target.value.toUpperCase().trim();
  if (!q) {
    document.getElementById("list").innerHTML =
      `<div class="empty">Start typing to search</div>`;
    return;
  }
  const words = q.split(" ");
  render(DATA.filter(r =>
    words.every(w =>
      ((r["Item Name"] || "") + (r["Item Code"] || ""))
      .toUpperCase().includes(w)
    )
  ));
});

/* SCROLL BOUNCE */
let lastScroll = 0;
window.addEventListener("scroll", () => {
  const max = document.body.scrollHeight - innerHeight;
  if ((scrollY <= 0 && lastScroll > 0) || (scrollY >= max && lastScroll < max)) {
    document.getElementById("app").classList.add("bounce");
    setTimeout(() => document.getElementById("app").classList.remove("bounce"), 400);
  }
  lastScroll = scrollY;
});

loadExcel();
</script>

</body>
</html>
