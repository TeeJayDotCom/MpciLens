<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FG Inventory Pro</title>

<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

<style>
/* =========================
   1. DESIGN TOKENS
========================= */
:root {
  --bg: #0e0f12;
  --surface: #16181d;
  --surface-soft: #1c1f26;
  --border: rgba(255,255,255,0.08);

  --text-primary: #f5f7fa;
  --text-secondary: #aab0bb;
  --text-muted: #6f7684;

  --accent: #3b82f6;
  --accent-soft: rgba(59,130,246,0.15);

  --radius-lg: 18px;
  --radius-md: 14px;
  --radius-sm: 10px;

  --shadow-soft: 0 10px 30px rgba(0,0,0,0.35);
  --shadow-lift: 0 18px 45px rgba(0,0,0,0.55);
}

/* =========================
   2. GLOBAL
========================= */
* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 20px;
  padding-bottom: 100px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Inter, Roboto, sans-serif;
  background: radial-gradient(1200px 600px at top, #14161c, var(--bg));
  color: var(--text-primary);
  -webkit-tap-highlight-color: transparent;
}

/* =========================
   3. STATUS BAR
========================= */
#status-bar {
  text-align: center;
  padding: 12px 16px;
  margin-bottom: 16px;
  font-size: 14px;
  color: var(--text-secondary);
  background: var(--surface);
  border-radius: var(--radius-md);
  border: 1px solid var(--border);
  box-shadow: var(--shadow-soft);
}

/* =========================
   4. SEARCH
========================= */
.search-container {
  position: sticky;
  top: 0;
  z-index: 100;
  padding-bottom: 16px;
  backdrop-filter: blur(8px);
}

.search-container input {
  width: 100%;
  padding: 18px 20px;
  font-size: 17px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.06),
    rgba(255,255,255,0.02)
  );
  color: var(--text-primary);
  outline: none;
  box-shadow: var(--shadow-soft);
}

.search-container input::placeholder {
  color: var(--text-muted);
}

.search-container input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 4px var(--accent-soft), var(--shadow-soft);
}

/* =========================
   5. LIST / EMPTY
========================= */
#listContainer {
  margin-top: 8px;
}

.empty-state {
  margin-top: 80px;
  text-align: center;
  color: var(--text-muted);
  font-size: 16px;
}

/* =========================
   6. CARD
========================= */
.card {
  background: linear-gradient(
    180deg,
    var(--surface),
    var(--surface-soft)
  );
  border-radius: var(--radius-lg);
  padding: 18px;
  margin-bottom: 14px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-soft);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  cursor: pointer;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lift);
}

.card-header {
  display: flex;
  justify-content: space-between;
  gap: 14px;
}

.info {
  flex: 1;
}

.name-row {
  display: flex;
  align-items: center;
  gap: 14px;
}

.item-icon {
  font-size: 30px;
}

.item-name {
  font-size: 18px;
  font-weight: 700;
  line-height: 1.3;
}

.item-code {
  display: inline-block;
  margin-left: 44px;
  margin-top: 6px;
  font-size: 13px;
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  color: var(--text-secondary);
  background: rgba(255,255,255,0.05);
  padding: 4px 8px;
  border-radius: 6px;
}

/* =========================
   7. QTY
========================= */
.qty-box {
  background: linear-gradient(180deg, #3b82f6, #2563eb);
  color: white;
  padding: 10px 12px;
  border-radius: var(--radius-md);
  text-align: center;
  min-width: 64px;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.15);
}

.qty-val {
  font-size: 20px;
  font-weight: 800;
}

.qty-lbl {
  font-size: 10px;
  opacity: 0.85;
  text-transform: uppercase;
}

/* =========================
   8. DETAILS
========================= */
.expand-btn {
  background: none;
  border: none;
  color: var(--accent);
  margin-top: 10px;
  margin-left: 44px;
  font-size: 14px;
  cursor: pointer;
}

.details {
  display: none;
  margin-left: 44px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px dashed var(--border);
  font-size: 13px;
  color: var(--text-secondary);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

/* =========================
   9. FAB
========================= */
.fab-container {
  position: fixed;
  bottom: 22px;
  right: 22px;
  display: flex;
  gap: 12px;
  z-index: 200;
}

.fab {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: none;
  background: linear-gradient(180deg, #3b82f6, #2563eb);
  color: white;
  font-size: 20px;
  cursor: pointer;
  box-shadow: var(--shadow-lift);
}

/* =========================
   10. TOAST
========================= */
#toast {
  visibility: hidden;
  position: fixed;
  left: 50%;
  bottom: 36px;
  transform: translateX(-50%);
  background: rgba(20,22,28,0.95);
  color: white;
  padding: 14px 20px;
  border-radius: 999px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-lift);
  font-size: 15px;
}

#toast.show {
  visibility: visible;
  animation: fadein 0.4s ease, fadeout 0.4s ease 2.6s;
}

@keyframes fadein {
  from { opacity: 0; transform: translate(-50%, 10px); }
  to { opacity: 1; transform: translate(-50%, 0); }
}

@keyframes fadeout {
  from { opacity: 1; }
  to { opacity: 0; }
}
</style>
</head>

<body>

<div id="status-bar">Initializingâ€¦</div>

<div class="search-container">
  <input id="searchInput" placeholder="Search by item name or codeâ€¦" />
</div>

<div id="listContainer">
  <div class="empty-state">Loading inventoryâ€¦</div>
</div>

<div id="toast">Copied to clipboard</div>

<div class="fab-container">
  <button class="fab" onclick="scrollTo(0,0)">â¬†</button>
  <button class="fab" onclick="scrollTo(0,document.body.scrollHeight)">â¬‡</button>
</div>

<script>
const FILE_NAME = "inventory.xlsx";
let allData = [];

function getIcon(name) {
  const n = name.toUpperCase();
  if (n.includes("CAP")) return "ðŸ”˜";
  if (n.includes("CUP")) return "ðŸ¥ƒ";
  if (n.includes("JAR")) return "ðŸ¯";
  if (n.includes("BOTTLE") || n.includes("PET")) return "ðŸ§´";
  if (n.includes("PUMP") || n.includes("SPRAY")) return "ðŸ”«";
  return "ðŸ“¦";
}

async function loadInventory() {
  const status = document.getElementById("status-bar");
  try {
    const res = await fetch(FILE_NAME + "?t=" + Date.now());
    if (!res.ok) throw new Error("File not found");

    const buf = await res.arrayBuffer();
    const wb = XLSX.read(buf);
    const sheet = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet);

    allData = rows.map(r => ({
      code: r["Item Code"] || "-",
      name: r["Item Name"] || "Unknown",
      qty: r["Quantity per Box"] || "-",
      weight: r["Weight"] || "-",
      height: r["Height"] || "-",
      ofc: r["OFC"] || "-",
      dia: r["Body Dia Major"] || "-"
    }));

    status.textContent = `Ready â€¢ ${allData.length} items loaded`;
    status.style.color = "#7dd3fc";

    document.getElementById("listContainer").innerHTML =
      `<div class="empty-state">Start typing to search</div>`;

  } catch (e) {
    status.textContent = "Error loading inventory";
    status.style.color = "#f87171";
  }
}

function renderList(items) {
  const c = document.getElementById("listContainer");
  c.innerHTML = "";
  if (!items.length) {
    c.innerHTML = `<div class="empty-state">No matches found</div>`;
    return;
  }

  items.forEach((it,i) => {
    const card = document.createElement("div");
    const icon = getIcon(it.name);
    card.className = "card";
    card.onclick = e => {
      if (e.target.className === "expand-btn") return;
      navigator.clipboard.writeText(
`${icon} ${it.name}
Code: ${it.code}
Qty/Box: ${it.qty}`
      ).then(showToast);
    };

    card.innerHTML = `
      <div class="card-header">
        <div class="info">
          <div class="name-row">
            <span class="item-icon">${icon}</span>
            <div class="item-name">${it.name}</div>
          </div>
          <div class="item-code">${it.code}</div>
        </div>
        <div class="qty-box">
          <div class="qty-val">${it.qty}</div>
          <div class="qty-lbl">Box</div>
        </div>
      </div>

      <button class="expand-btn" onclick="toggleDetails('d${i}')">View specs</button>
      <div id="d${i}" class="details">
        <div>Weight: ${it.weight}</div>
        <div>Height: ${it.height}</div>
        <div>OFC: ${it.ofc}</div>
        <div>Dia: ${it.dia}</div>
      </div>
    `;
    c.appendChild(card);
  });
}

function toggleDetails(id) {
  const el = document.getElementById(id);
  el.style.display = el.style.display === "grid" ? "none" : "grid";
}

function showToast() {
  const t = document.getElementById("toast");
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 3000);
}

document.getElementById("searchInput").addEventListener("input", e => {
  const q = e.target.value.trim().toUpperCase();
  if (!q) {
    document.getElementById("listContainer").innerHTML =
      `<div class="empty-state">Start typing to search</div>`;
    return;
  }
  const words = q.split(" ");
  renderList(allData.filter(i =>
    words.every(w => (i.name + i.code).toUpperCase().includes(w))
  ));
});

loadInventory();
</script>

</body>
</html>
